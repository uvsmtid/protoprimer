---
feature_topic: FT_28_25_63_06
topic_title: isolated python
topic_status: TODO
---

## Intro

When `python` imports non-standard module, it must import it from the dedicated `venv`.

The `protoprimer` is designed to work in isolated environment sharing no non-standard packages.
This allows multiple independent deployments on the same host for the same user.

It covers both cases (see [FT_93_57_03_75.app_vs_lib.md][FT_93_57_03_75.app_vs_lib.md]):
*   `app`: if it imports `protoprimer` itself or any module depending on `protoprimer`, it must be from `venv`.
*   `lib`: if an entry script imports a module, it must be from `venv`

The only exception to this rule is `proto_code` (see [FT_90_65_67_62.proto_code.md][FT_90_65_67_62.proto_code.md]):
*   The `proto_code` is the opposite - it must not be from `venv`.
*   But it also must not be from non-`venv` shared `site-packages` (e.g. `~/.local/lib`).

## Approach

The general approach is to always switch `python` to isolated mode (see `python -I`).

This also solves the problem of unnecessary `python` restart to obtain the path to `proto_code`.

### CASE_1: `lib`

The `protoprimer` used as `lib` requires `entry_script`-s to be aware of the relative path to `proto_code`.
The `entry_script` loads `proto_code` module via that relative path.

Then, it initiates `python` switch sequence.

See also [UC_54_26_66_63.lib_access_to_config_data.md][UC_54_26_66_63.lib_access_to_config_data.md].

### CASE_2: `app` starting directly from `proto_code`

TODO: explain

### CASE_3: `app` starting from `entry_script`

This is identical to CASE_1 `lib` - the only difference is the selected main function.

## Diagram

TODO: add mermaid diagram with transitions of `python` processes.

## Related articles

`feature_topic`-s:
*   [FT_02_89_37_65.shebang_line.md][FT_02_89_37_65.shebang_line.md]
*   [FT_14_52_73_23.primer_runtime.md][FT_14_52_73_23.primer_runtime.md]
*   [FT_22_11_94_65.bootstrap_precondition.md][FT_22_11_94_65.bootstrap_precondition.md]
*   [FT_44_72_60_67.python_vs_shell.md][FT_44_72_60_67.python_vs_shell.md]
*   [FT_46_37_27_11.editable_install.md][FT_46_37_27_11.editable_install.md]
*   [FT_57_87_94_94.bootstrap_process.md][FT_57_87_94_94.bootstrap_process.md]
*   [FT_62_88_55_10.CLI_compatibility.md][FT_62_88_55_10.CLI_compatibility.md]
*   [FT_72_45_12_06.python_executable.md][FT_72_45_12_06.python_executable.md]
*   [FT_75_87_82_46.entry_script.md][FT_75_87_82_46.entry_script.md]
*   [FT_90_65_67_62.proto_code.md][FT_90_65_67_62.proto_code.md]

`use_case`-s:
*   [UC_90_98_17_93.run_under_venv.md][UC_90_98_17_93.run_under_venv.md]

---

[FT_02_89_37_65.shebang_line.md]: FT_02_89_37_65.shebang_line.md
[FT_14_52_73_23.primer_runtime.md]: FT_14_52_73_23.primer_runtime.md
[FT_22_11_94_65.bootstrap_precondition.md]: FT_22_11_94_65.bootstrap_precondition.md
[FT_44_72_60_67.python_vs_shell.md]: FT_44_72_60_67.python_vs_shell.md
[FT_46_37_27_11.editable_install.md]: FT_46_37_27_11.editable_install.md
[FT_57_87_94_94.bootstrap_process.md]: FT_57_87_94_94.bootstrap_process.md
[FT_62_88_55_10.CLI_compatibility.md]: FT_62_88_55_10.CLI_compatibility.md
[FT_72_45_12_06.python_executable.md]: FT_72_45_12_06.python_executable.md
[FT_75_87_82_46.entry_script.md]: FT_75_87_82_46.entry_script.md
[FT_90_65_67_62.proto_code.md]: FT_90_65_67_62.proto_code.md
[FT_93_57_03_75.app_vs_lib.md]: FT_93_57_03_75.app_vs_lib.md

[UC_90_98_17_93.run_under_venv.md]: ../use_case/UC_90_98_17_93.run_under_venv.md
[UC_54_26_66_63.lib_access_to_config_data.md]: ../use_case/UC_54_26_66_63.lib_access_to_config_data.md
